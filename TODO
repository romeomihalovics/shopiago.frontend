Transitions here and there, code clean up, bug fixes